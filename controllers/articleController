const Article = require('../model/Article');

const handleNewArticle = async (req, res) => {
    const {title, content} = req.body;
    if (!title || !content) return res.status(400).json({ message: 'Title and Content are required.'});

    const duplicate = await Article.findOne({ title: title}).exec();
    if (duplicate) return res.sendStatus(409);

    try {
        const result = await Article.create({
            title: title,
            content: content,
            author: author
            // How to define the author being the logged in person?
            // Potentially issues due to using the same variable name as model's data name
            // Try to update the author user's "posts" with the ID of THIS post?
            // Try to use Mongodb Auto _id's or to create own?
        });

        console.log(result);
        res.status(201).json({ message: `New article "${title}" created!`});
    } catch (err) {
        res.status(500).json({ message: err.message});
    }
};

module.exports = { handleNewArticle };